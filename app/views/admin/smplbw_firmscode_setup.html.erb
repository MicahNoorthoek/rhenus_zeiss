<!DOCTYPE html>
<html>
  <head>

    <style>
     .searchform {
        width: 30%;
      }

     .form-control:focus {
        border-color: #979796;
        box-shadow: none;
        radius: 0;
      }

     .linktext{
        color: #404040;
        border: none;
        background-color: none;
      }
    </style>
  </head>
  <body>

      <div class="content-squish-screens">
        <h6 class = "pghead2" style="margin-bottom:40px;"><a style="color:#0061e0; font-style:italic;" href="<%= admin_path %>">Admin</a> / <a style="color:#0061e0; font-style:italic;" href="<%= smplbw_users_path %>">Users</a> / User Firmscode Setup</h6>

        <div class="row">
          <div class="col-6 padding-adjust">
            <%= search_form_for @ua, as: :users, url: smplbw_firmscode_setup_path  do |f| %>
<br>
              <div class="row">
                <div class="col-5 padding-adjust">
                  <%= f.text_field :email_cont, class: "form-control input-sm", placeholder: "Search email..."%>
                </div>
                <div class="col-5">
                  <%= link_to "Clear Search", request.path, class:"cancel-button btn btn-light btn-sm btn-search" %>
                </div>
              </div> <!-- end second row -->
            <% end %>
          </div>
          <div class="col-3">

          </div>
          <div class="col btn-lock-padding">

          </div>
          <div class="col-1">

          </div>
        </div><!-- end row-->
        <br>
        <div class="table-responsive resptbl-class">
          <table id="ftztable" class="table table-striped table-sm table-hover display responsive no-wrap">
            <thead class="thead-dark">
              <thead>
                <tr>
                  <th>Edit</th>
                  <th>Company</th>
                  <th>Username</th>
                  <th>Email</th>
                  <th>Warehouse Access</th>
                </tr>
              </thead>
              <tbody id="myTable">
                <% @users.each do |f| %>
                  <tr>
                    <td class="pad-tr"><%= link_to '<i class="fa fa-pencil-alt fa-sm center" aria-hidden="true"></i>'.html_safe, edit_user_firmscode_path(email: f.email), remote: true, class: "icon-edit", style: 'float:left; padding-left: 15px; padding-right: -20px;'%></td>
                    
                    <% if User.where(email: f.email).pluck(:company).first.present? %>
                      <td class="pad-tr"><%= User.where(email: f.email).pluck(:company).first %></td>
                    <% else %>
                      <td class="pad-tr" style="font-weight: bold;">Account Pending</td>
                    <% end %>

                    <% if User.where(email: f.email).pluck(:username).first.present? %>
                      <td class="pad-tr"><%= User.where(email: f.email).pluck(:username).first %></td>
                    <% else %>
                      <td class="pad-tr" style="font-weight: bold;">Account Pending</td>
                    <% end %>
             
                    <td class="pad-tr"><%= f.email %></td>
                    <td class="pad-tr">
                      <% useraccess_list = Useraccess.where(email: f.email).order(warehouse: :asc) %>
                      <% useraccess_list.each_with_index do |useraccess, index| %>
                        <%= useraccess.warehouse %>
                        <%= ',' unless index == useraccess_list.size - 1 %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </thead>
          </table>
        </div>


        <div class="ftz_pagination">

          <%= will_paginate @users, :previous_label => 'prev', :next_label => 'next', param_name: 'users_page' %>

        </div>


      </div>



  </body>
</html>
